     1                                  ; C3  equ 0x017C  ; = 131Hz
     2                                  ; Cs3 equ 0x0167  ; = 138Hz
     3                                  ; D3  equ 0x0152  ; = 147Hz
     4                                  ; Ds3 equ 0x013F  ; = 156Hz
     5                                  ; E3  equ 0x012D  ; = 165Hz
     6                                  ; F3  equ 0x011C  ; = 175Hz
     7                                  
     8                                  G3  equ 0xFD  ;253 = 196Hz
     9                                  A3  equ 0xE1  ;225 = 220Hz
    10                                  B3  equ 0xC9  ;201 = 247Hz
    11                                  ; -----
    12                                  C4  equ 0xBE  ;190 = 262Hz
    13                                  D4  equ 0xA8  ;168 = 294Hz
    14                                  E4  equ 0x96  ;150 = 330Hz
    15                                  F4  equ 0x8E  ;142 = 349Hz
    16                                  G4  equ 0x7E  ;    = 393Hz
    17                                  Gs4 equ 0x77  ;    = 416Hz
    18                                  A4  equ 0x70  ;    = 442Hz
    19                                  As4 equ 0x6A  ;    = 466Hz
    20                                  B4  equ 0x64  ;    = 494Hz
    21                                  ; -----
    22                                  C5  equ 0x5e  ;    = 527Hz
    23                                  D5  equ 0x54  ;    = 588Hz
    24                                  Ds5 equ 0x4F  ;    = 625Hz
    25                                  E5  equ 0x4B  ;    = 658Hz
    26                                  F5  equ 0x47  ;    = 695Hz
    27                                  Fs5 equ 0x43  ;    = 736Hz
    28                                  G5  equ 0x3F  ;    = 782Hz 
    29                                  Gs5 equ 0x3B  ; 
    30                                  A5  equ 0x37  ;    = 881Hz
    31                                  B5  equ 0x34  ;    = ????
    32                                  ; ----
    33                                  C6  equ 0x2F  ;    = ???
    34                                  
    35                                  T equ 4*32 
    36                                  
    37                                  setup:
    38 00000000 0E                        push cs
    39 00000001 1F                        pop ds
    40 00000002 BE[8600]                  mov si,song
    41                                  
    42                                  update:
    43 00000005 45                        inc bp
    44                                    
    45                                    ; cmp bp,0x21
    46                                    ; jl .ch1
    47 00000006 F7C50100                  test bp,1
    48 0000000A 750D                      jnz .ch2
    49                                  
    50                                  ;#########
    51                                  .ch1:
    52 0000000C B700                        mov bh,0
    53 0000000E AC                          lodsb
    54 0000000F 88C3                        mov bl,al
    55 00000011 BA0A00                      mov dx,10
    56 00000014 E85800                      call play
    57 00000017 EB48                        jmp .done_ch
    58                                  
    59                                  .ch2:
    60 00000019 51                          push cx
    61 0000001A 89E9                        mov cx,bp
    62 0000001C A0[6C00]                    mov al,[mm]
    63 0000001F 30E4                        xor ah,ah
    64 00000021 21C1                        and cx,ax
    65                                  
    66 00000023 D3E3                        shl bx,cl
    67 00000025 59                          pop cx
    68 00000026 8B16[6D00]                  mov dx,[dv]
    69                                  
    70 0000002A E84200                      call play
    71                                  
    72 0000002D A0[6C00]                    mov al,[mm]
    73                                  
    74                                   
    75 00000030 81FD8002                    cmp bp,(5+1/2)*T
    76 00000034 7F1A                        jg .q
    77                                  
    78 00000036 81FD0002                    cmp bp,4*T
    79 0000003A 7F15                        jg .p
    80                                  
    81 0000003C 81FD8001                    cmp bp,3*T
    82 00000040 7F1C                        jg .z
    83                                  
    84 00000042 81FD0001                    cmp bp,2*T
    85 00000046 7F0E                        jg .x
    86                                  
    87 00000048 81FD8000                    cmp bp,1*T
    88 0000004C 7F0E                        jg .y
    89 0000004E EB11                        jmp .done_ch
    90                                  
    91 00000050 F4                      .q: hlt
    92                                  
    93 00000051 8306[6D00]02            .p: add word [dv],2
    94                                  
    95                                  .x:
    96 00000056 D0C8                        ror al,1
    97 00000058 D0C8                        ror al,1
    98 0000005A D0C8                        ror al,1
    99                                  .y:
   100 0000005C D0C0                        rol al,1
   101                                  .z:
   102 0000005E A2[6C00]                    mov [mm],al
   103                                  
   104                                  .done_ch:
   105                                  
   106 00000061 81FE[A600]                cmp si,song+32
   107 00000065 729E                      jb update
   108 00000067 BE[8600]                  mov si,song
   109 0000006A EB99                      jmp update
   110                                  
   111 0000006C 01                      mm: db 1
   112 0000006D 3C00                    dv: dw 60
   113                                  
   114                                  play:             ; bx=note, dx=duration
   115 0000006F 89D9                       mov cx,bx
   116 00000071 B83500                     mov ax,0x35
   117 00000074 3408                    .a xor al,8       ; toggle 'break' bit
   118 00000076 E63A                       out 0x3a,al    ; USART
   119 00000078 FECC                    .b dec ah
   120 0000007A 7503                       jnz .c
   121 0000007C 4A                         dec dx
   122 0000007D 7406                       jz .d
   123 0000007F E2F7                    .c loop .b
   124 00000081 89D9                       mov cx,bx      ; reset note
   125 00000083 EBEF                       jmp .a
   126                                  .d 
   127                                  ; xor al,8       ; toggle 'control' bit
   128                                  ;    cmp al,0x35    ; 'break' now on?
   129                                  ;    jnz .e         ; jump if not
   130                                  ;    out 0x3A,al    ; reset USART
   131 00000085 C3                      .e ret
   132                                  
   133                                  song:
   134 00000086 FDBE96BE                db G3,C4,E4,C4
   135 0000008A FDBE96BE                db G3,C4,E4,C4
   136 0000008E FDC9A8C9                db G3,B3,D4,B3
   137 00000092 FDC9A8C9                db G3,B3,D4,B3
   138 00000096 E1A88EA8                db A3,D4,F4,D4
   139 0000009A E1A88EA8                db A3,D4,F4,D4
   140 0000009E E1BE96BE                db A3,C4,E4,C4
   141 000000A2 E1BE96BE                db A3,C4,E4,C4
   142                                  
   143                                  ; ch2:
   144                                  ; db G3,G3,G3,G3
   145                                  ; db G3,G3,G3,G3
   146                                  ; db G3,G3,G3,G3
   147                                  ; db G3,G3,G3,G3
   148                                  ; db G3,G3,G3,G3
   149                                  ; db G3,G3,G3,G3
   150                                  ; db G3,G3,G3,G3
   151                                  ; db G3,G3,G3,G3
   152                                  
   153                                  ; C - G - Am - Em - F - C - F - G
   154                                  ; dw C4,E4,G4, C5,E5,G5   ;C
   155                                  ; dw C4,E4,G4, C5,E5,G5   ;C
   156                                  
   157                                  ; dw G3,B3,D4, G4,B4,D5   ;G
   158                                  ; dw G3,B3,D4, G4,B4,D5   ;G
   159                                  
   160                                  ; dw A3,C4,E4, A4,C5,E5   ;Am
   161                                  ; dw A3,C4,E4, A4,C5,E5   ;Am
   162                                  
   163                                  ; dw E3,G3,B3, E4,G4,B4   ;Em
   164                                  ; dw E3,G3,B3, E4,G4,B4   ;Em
   165                                  
   166                                  ; dw F3,A3,C4, F4,A4,C5   ;F
   167                                  ; dw F3,A3,C4, F4,A4,C5   ;F
   168                                  
   169                                  ; dw C4,E4,G4, C5,E5,G5   ;C
   170                                  ; dw C4,E4,G4, C5,E5,G5   ;C
   171                                  
   172                                  ; dw F3,A3,C4, F4,A4,C5   ;F
   173                                  ; dw F3,A3,C4, F4,A4,C5   ;F
   174                                  
   175                                  ; dw G3,B3,D4, G4,B4,D5   ;G
   176                                  ; dw G3,B3,D4, G4,B4,D5   ;G
   177                                  
   178                                  
   179                                  ; ; zelfde maar rechter hand in andere volgorde
   180                                  ; ; C - G - Am - Em - F - C - F - G
   181                                  
   182                                  ; ; C
   183                                  ; dw C4,E4,G4 ; linker hand
   184                                  ; dw C5,E5,G5,C6,G5,E5,  C5    ; rechterhand >>>> <<
   185                                  ; dw G4,E4 ; linker hand
   186                                  
   187                                  ; ; G
   188                                  ; dw G3,B3,D4 ; linker hand
   189                                  ; dw G4,B4,D5,G5,D5,B4,  G4    ; rechter hand
   190                                  ; dw D4,B3 ; linker hand
   191                                  
   192                                  ; ; Am
   193                                  ; dw A3,C4,E4 ; linker hand
   194                                  ; dw A4,C5,E5,A5,E5,C5,  A4    ; rechter hand
   195                                  ; dw E4,C4 ; linker hand
   196                                  
   197                                  ; ; Em
   198                                  ; dw E3,G3,B3 ; linker hand
   199                                  ; dw E4,G4,B4,E5,B4,G4,  E4  ; rechter hand
   200                                  ; dw B3,G3 ; linker hand
   201                                  
   202                                  ; ; F
   203                                  ; dw F3,A3,C4 ; linker hand
   204                                  ; dw F4,A4,C5,F5,C5,A4,  F4  ; rechter hand
   205                                  ; dw C4,A3 ; linker hand
   206                                  
   207                                  ; ; C 
   208                                  ; dw C4,E4,G4 ; linker hand
   209                                  ; dw C5,E5,G5,C6,G5,E5,  C5 ; rechterhand >>>> <<
   210                                  ; dw G4,E4 ; linker hand
   211                                  
   212                                  ; ; F
   213                                  ; dw F3,A3,C4 ; linker hand
   214                                  ; dw F4,A4,C5,F5,C5,A4,  F4  ; rechter hand
   215                                  ; dw C4,A3 ; linker hand
   216                                  
   217                                  ; ; G
   218                                  ; dw G3,B3,D4 ; linker hand
   219                                  ; dw G4,B4,D5,G5,D5,B4,  G4 ; rechter hand
   220                                  ; dw D4,B3 ; linker hand
   221                                  
   222                                  
   223                                  
   224                                  
   225                                  
   226                                  
   227                                  
   228                                  %assign num $-$$
   229                                  %warning total num
   229          ******************       warning: total 166 [-w+user]
   230 000000A6 00<rep 2CF5Ah>          times (180*1024)-num db 0
   231                                  
   232                                  
   233                                  
   234                                  
   235                                  
   236                                  
   237                                  
   238                                  ; ; C3  equ 0x017C  ; = 131Hz
   239                                  ; ; Cs3 equ 0x0167  ; = 138Hz
   240                                  ; ; D3  equ 0x0152  ; = 147Hz
   241                                  ; ; Ds3 equ 0x013F  ; = 156Hz
   242                                  ; ; E3  equ 0x012D  ; = 165Hz
   243                                  ; ; F3  equ 0x011C  ; = 175Hz
   244                                  
   245                                  ; G3  equ 0xFD  ;253 = 196Hz
   246                                  ; A3  equ 0xE1  ;225 = 220Hz
   247                                  ; B3  equ 0xC9  ;201 = 247Hz
   248                                  ; ; -----
   249                                  ; C4  equ 0xBE  ;190 = 262Hz
   250                                  ; D4  equ 0xA8  ;168 = 294Hz
   251                                  ; E4  equ 0x96  ;150 = 330Hz
   252                                  ; F4  equ 0x8E  ;142 = 349Hz
   253                                  ; G4  equ 0x7E  ;    = 393Hz
   254                                  ; Gs4 equ 0x77  ;    = 416Hz
   255                                  ; A4  equ 0x70  ;    = 442Hz
   256                                  ; As4 equ 0x6A  ;    = 466Hz
   257                                  ; B4  equ 0x64  ;    = 494Hz
   258                                  ; ; -----
   259                                  ; C5  equ 0x5e  ;    = 527Hz
   260                                  ; D5  equ 0x54  ;    = 588Hz
   261                                  ; Ds5 equ 0x4F  ;    = 625Hz
   262                                  ; E5  equ 0x4B  ;    = 658Hz
   263                                  ; F5  equ 0x47  ;    = 695Hz
   264                                  ; Fs5 equ 0x43  ;    = 736Hz
   265                                  ; G5  equ 0x3F  ;    = 782Hz 
   266                                  ; Gs5 equ 0x3B  ; 
   267                                  ; A5  equ 0x37  ;    = 881Hz
   268                                  ; B5  equ 0x34  ;    = ????
   269                                  ; ; ----
   270                                  ; C6  equ 0x2F  ;    = ???
   271                                  
   272                                  ; setup:
   273                                  ;   push cs
   274                                  ;   pop ds
   275                                  ;   push cs
   276                                  ;   pop es
   277                                  ;   mov si,song
   278                                  ;   ; mov di,data
   279                                  
   280                                  ; ; l:
   281                                  ; ;   mov bx,C4
   282                                  ; ;   mov dx,50
   283                                  ; ;   call play_note
   284                                  ; ;   jmp l
   285                                  
   286                                  ; update:
   287                                  ;   mov bh,0
   288                                  ;   lodsb
   289                                  ;   ; xchg ax,bx
   290                                  ;   mov bl,al
   291                                  ;   mov dx,75
   292                                  ;   call play_note
   293                                  
   294                                  ;   cmp si,song+32
   295                                  ;   jb update
   296                                  ;   hlt
   297                                    
   298                                  ;   ; mov si,song
   299                                  ;   ; jmp update
   300                                  
   301                                  ; ;   mov si,data
   302                                  
   303                                  ; ; play_loop:
   304                                  
   305                                  ; ;    lodsb
   306                                  ; ;    out 0x3a,al
   307                                  
   308                                  ; ;    mov cx,1
   309                                  ; ;    delay:
   310                                  ; ;    loop delay
   311                                  
   312                                  ; ;    cmp si,data+50000
   313                                  ; ;    jb play_loop
   314                                  
   315                                  ; ;    mov si,data
   316                                  ; ;    jmp play_loop
   317                                  
   318                                  ; ;   hlt
   319                                  
   320                                  ; play_org:             ; bx=note, dx=duration
   321                                  ;    ; push ax
   322                                  ;    ; push bx
   323                                  ;    ; push cx
   324                                  ;    ; push dx
   325                                  ;    mov cx,bx
   326                                  ;    mov ax,0x35
   327                                  ; .a xor al,8       ; toggle 'break' bit
   328                                  ;    out 0x3a,al    ; USART
   329                                  ; .b dec ah
   330                                  ;    jnz .c
   331                                  ;    dec dx
   332                                  ;    jz .d
   333                                  ; .c loop .b
   334                                  ;    mov cx,bx      ; reset note
   335                                  ;    jmp .a
   336                                  ; .d xor al,8       ; toggle 'control' bit
   337                                  ;    cmp al,0x35    ; 'break' now on?
   338                                  ;    jnz .e         ; jump if not
   339                                  ;    out 0x3A,al    ; reset USART
   340                                  ; .e ret
   341                                  ;   ; pop dx
   342                                  ;   ;  pop cx
   343                                  ;   ;  pop bx
   344                                  ;   ;  pop ax
   345                                  ;   ;  ret
   346                                  
   347                                  
   348                                  ; play_note:             ; bx=note, dx=duration
   349                                  ;    mov cx,bx
   350                                  ;    ; xor ax,ax
   351                                  ;    mov ax,0x35
   352                                  ; .a xor al,8
   353                                  ;    out 0x3a,al
   354                                  ; .b dec ah
   355                                  ;    jnz .c
   356                                  ;    dec dx
   357                                  ;    jz .d
   358                                  ; .c loop .b
   359                                  ;    mov cx,bx      ; reset note
   360                                  ;    jmp .a
   361                                  ; .d ret
   362                                  
   363                                  ; song:
   364                                  ; db G3,C4,E4,C4
   365                                  ; db G3,C4,E4,C4
   366                                  ; db G3,B3,D4,B3
   367                                  ; db G3,B3,D4,B3
   368                                  ; db A3,D4,F4,D4
   369                                  ; db A3,D4,F4,D4
   370                                  ; db A3,C4,E4,C4
   371                                  ; db A3,C4,E4,C4
   372                                  
   373                                  ; data:
   374                                  
   375                                  ; ; C - G - Am - Em - F - C - F - G
   376                                  ; ; dw C4,E4,G4, C5,E5,G5   ;C
   377                                  ; ; dw C4,E4,G4, C5,E5,G5   ;C
   378                                  
   379                                  ; ; dw G3,B3,D4, G4,B4,D5   ;G
   380                                  ; ; dw G3,B3,D4, G4,B4,D5   ;G
   381                                  
   382                                  ; ; dw A3,C4,E4, A4,C5,E5   ;Am
   383                                  ; ; dw A3,C4,E4, A4,C5,E5   ;Am
   384                                  
   385                                  ; ; dw E3,G3,B3, E4,G4,B4   ;Em
   386                                  ; ; dw E3,G3,B3, E4,G4,B4   ;Em
   387                                  
   388                                  ; ; dw F3,A3,C4, F4,A4,C5   ;F
   389                                  ; ; dw F3,A3,C4, F4,A4,C5   ;F
   390                                  
   391                                  ; ; dw C4,E4,G4, C5,E5,G5   ;C
   392                                  ; ; dw C4,E4,G4, C5,E5,G5   ;C
   393                                  
   394                                  ; ; dw F3,A3,C4, F4,A4,C5   ;F
   395                                  ; ; dw F3,A3,C4, F4,A4,C5   ;F
   396                                  
   397                                  ; ; dw G3,B3,D4, G4,B4,D5   ;G
   398                                  ; ; dw G3,B3,D4, G4,B4,D5   ;G
   399                                  
   400                                  
   401                                  ; ; ; zelfde maar rechter hand in andere volgorde
   402                                  ; ; ; C - G - Am - Em - F - C - F - G
   403                                  
   404                                  ; ; ; C
   405                                  ; ; dw C4,E4,G4 ; linker hand
   406                                  ; ; dw C5,E5,G5,C6,G5,E5,  C5    ; rechterhand >>>> <<
   407                                  ; ; dw G4,E4 ; linker hand
   408                                  
   409                                  ; ; ; G
   410                                  ; ; dw G3,B3,D4 ; linker hand
   411                                  ; ; dw G4,B4,D5,G5,D5,B4,  G4    ; rechter hand
   412                                  ; ; dw D4,B3 ; linker hand
   413                                  
   414                                  ; ; ; Am
   415                                  ; ; dw A3,C4,E4 ; linker hand
   416                                  ; ; dw A4,C5,E5,A5,E5,C5,  A4    ; rechter hand
   417                                  ; ; dw E4,C4 ; linker hand
   418                                  
   419                                  ; ; ; Em
   420                                  ; ; dw E3,G3,B3 ; linker hand
   421                                  ; ; dw E4,G4,B4,E5,B4,G4,  E4  ; rechter hand
   422                                  ; ; dw B3,G3 ; linker hand
   423                                  
   424                                  ; ; ; F
   425                                  ; ; dw F3,A3,C4 ; linker hand
   426                                  ; ; dw F4,A4,C5,F5,C5,A4,  F4  ; rechter hand
   427                                  ; ; dw C4,A3 ; linker hand
   428                                  
   429                                  ; ; ; C 
   430                                  ; ; dw C4,E4,G4 ; linker hand
   431                                  ; ; dw C5,E5,G5,C6,G5,E5,  C5 ; rechterhand >>>> <<
   432                                  ; ; dw G4,E4 ; linker hand
   433                                  
   434                                  ; ; ; F
   435                                  ; ; dw F3,A3,C4 ; linker hand
   436                                  ; ; dw F4,A4,C5,F5,C5,A4,  F4  ; rechter hand
   437                                  ; ; dw C4,A3 ; linker hand
   438                                  
   439                                  ; ; ; G
   440                                  ; ; dw G3,B3,D4 ; linker hand
   441                                  ; ; dw G4,B4,D5,G5,D5,B4,  G4 ; rechter hand
   442                                  ; ; dw D4,B3 ; linker hand
   443                                  
   444                                  
   445                                  
   446                                  
   447                                  
   448                                  
   449                                  
   450                                  ; %assign num $-$$
   451                                  ; %warning total num
   452                                  ; times (180*1024)-num db 0
   453                                  
   454                                  
